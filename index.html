<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Rs 10 Lucky Draw</title>
<style>
body{margin:0;font-family:'Segoe UI',Tahoma,sans-serif;background:radial-gradient(circle at top,#1a2a3a,#0b141e 70%);color:#fff;}
header{padding:30px;text-align:center;}
header h1{color:#ffd700;font-size:2.5rem;margin-bottom:5px;}
header p{opacity:.8;font-size:1rem;}
.container{max-width:900px;margin:auto;padding:20px;}
.card{background:rgba(255,255,255,0.05);padding:25px;border-radius:20px;margin-bottom:25px;box-shadow:0 10px 30px rgba(0,0,0,0.5);}
input,button,select{padding:12px;border-radius:12px;border:none;font-size:1rem;margin-bottom:10px;}
input,select{width:100%;}
button{cursor:pointer;background:linear-gradient(135deg,#ffd700,#ffea00);color:#000;font-weight:bold;}
button:hover{opacity:.9}
.total{text-align:center;color:#00ffd5;font-weight:600;margin-bottom:10px;}
.ticket-box{margin-top:15px;background:linear-gradient(135deg,#ffd700,#ffb700);padding:15px;border-radius:15px;display:none;}
.ticket-box h3{margin:5px 0;}
.whatsapp{display:inline-block;margin-top:10px;padding:10px 18px;background:#25D366;color:#fff;text-decoration:none;border-radius:10px;font-weight:600;margin-right:10px;}
footer{text-align:center;padding:20px;font-size:0.9rem;opacity:0.8;}
button:disabled{opacity:0.5;cursor:not-allowed;}
</style>
</head>
<body>
<header>
<h1>ðŸŽŸ Rs 10 Lucky Draw</h1>
<p>Buy tickets via Easypaisa, JazzCash, or Nayapay and get your lucky numbers!</p>
</header>

<div class="container">
  <div class="card">
    <h2>Buy Tickets / Search Entries</h2>
    <input id="name" type="text" placeholder="Full Name">
    <input id="phone" type="tel" placeholder="WhatsApp Number">
    <input id="tickets" type="number" placeholder="Number of Tickets" min="1">
    <div class="total" id="total">Total: Rs 0</div>

    <select id="paymentMethod">
      <option value="">Select Payment Method</option>
      <option value="Easypaisa">Easypaisa</option>
      <option value="JazzCash">JazzCash</option>
      <option value="Nayapay">Nayapay</option>
    </select>
    
    <div id="paymentInfo" style="margin-bottom:10px;"></div>

    <button id="paymentProofBtn">Send Payment Proof via WhatsApp</button>
    <button id="generateBtn" disabled>Generate Tickets</button>
    <p id="statusMsg" style="color:#00ffd5;font-weight:600;"></p>

    <h3>Search My Tickets</h3>
    <input id="searchPhone" type="tel" placeholder="Enter WhatsApp Number to Search">
    <button id="searchBtn">Search</button>

    <div class="ticket-box" id="ticketBox">
      <h3>Your Tickets</h3>
      <p><strong>Name:</strong> <span id="tName"></span></p>
      <p><strong>WhatsApp:</strong> <span id="tPhone"></span></p>
      <p><strong>Tickets:</strong> <span id="tIds"></span></p>
      <a class="whatsapp" href="https://wa.me/+923278568763" target="_blank">Contact Organizer</a>
      <a class="whatsapp" id="shareWhatsApp" target="_blank">Share Payment on WhatsApp</a>
    </div>
  </div>
</div>

<footer>Â© 2025 Lucky Draw. All Rights Reserved.</footer>

<script>
let ticketsData = JSON.parse(localStorage.getItem('luckyDrawTickets') || '{}');
let paymentConfirmed = {}; // Track if payment proof clicked

// Update total
const ticketsInput = document.getElementById('tickets');
const totalDisplay = document.getElementById('total');
ticketsInput.addEventListener('input',()=>{
  const val = Number(ticketsInput.value)||0;
  totalDisplay.textContent='Total: Rs '+(val*10);
});

// Payment info
const paymentMethod = document.getElementById('paymentMethod');
const paymentInfo = document.getElementById('paymentInfo');
const paymentNumber = '+923409909351';
paymentMethod.addEventListener('change',()=>{
  if(paymentMethod.value){
    paymentInfo.innerHTML=`Send payment via <strong>${paymentMethod.value}</strong> to number: <strong>${paymentNumber}</strong>`;
  } else paymentInfo.innerHTML='';
});

// Generate random tickets
function generateTickets(count){
  let arr=[];
  for(let i=0;i<count;i++) arr.push('T'+Math.floor(100000+Math.random()*900000));
  return arr;
}

// Show tickets
function showTickets(data, phone){
  document.getElementById('tName').textContent = data.name;
  document.getElementById('tPhone').textContent = phone;
  document.getElementById('tIds').textContent = data.tickets.join(', ');
  document.getElementById('ticketBox').style.display='block';

  const msg = `I have sent payment via ${data.method} for Lucky Draw. Name: ${data.name}, Tickets: ${data.tickets.length}.`;
  document.getElementById('shareWhatsApp').href=`https://wa.me/${paymentNumber}?text=${encodeURIComponent(msg)}`;
  document.getElementById('shareWhatsApp').textContent='Share Payment on WhatsApp';
}

// Payment Proof button
document.getElementById('paymentProofBtn').addEventListener('click',()=>{
  const name=document.getElementById('name').value.trim();
  const phone=document.getElementById('phone').value.trim();
  const count=Number(document.getElementById('tickets').value);
  const method=document.getElementById('paymentMethod').value;

  if(!name || !phone || !count || !method){
    alert('Please fill all fields and select payment method');
    return;
  }

  // Open WhatsApp with pre-filled message
  const msg = `I have sent payment via ${method} for Lucky Draw. Name: ${name}, Tickets: ${count}. Please attach payment screenshot.`;
  window.open(`https://wa.me/${paymentNumber}?text=${encodeURIComponent(msg)}`, '_blank');

  // Enable generate tickets button
  paymentConfirmed[phone] = true;
  document.getElementById('generateBtn').disabled = false;
  document.getElementById('statusMsg').textContent='Payment proof sent! Now click "Generate Tickets".';
});

// Generate Tickets button
document.getElementById('generateBtn').addEventListener('click',()=>{
  const name=document.getElementById('name').value.trim();
  const phone=document.getElementById('phone').value.trim();
  const count=Number(document.getElementById('tickets').value);
  const method=document.getElementById('paymentMethod').value;

  if(!paymentConfirmed[phone]){
    alert('Please send payment proof first!');
    return;
  }

  if(ticketsData[phone]){
    alert('Tickets already generated for this number!');
    showTickets(ticketsData[phone], phone);
    return;
  }

  const tickets = generateTickets(count);
  ticketsData[phone] = {name, tickets, method};
  localStorage.setItem('luckyDrawTickets', JSON.stringify(ticketsData));

  showTickets(ticketsData[phone], phone);

  document.getElementById('statusMsg').textContent='Tickets generated successfully!';
  document.getElementById('generateBtn').disabled = true; // Disable again to prevent duplicate
});

// Search tickets
document.getElementById('searchBtn').addEventListener('click',()=>{
  const phone = document.getElementById('searchPhone').value.trim();
  if(!phone){ alert('Enter WhatsApp number to search'); return; }
  if(ticketsData[phone]){
    showTickets(ticketsData[phone], phone);
  } else {
    alert('No tickets found for this number.');
  }
});
</script>
</body>
</html>